!function(e){"use strict";function t(e,n){if(!(this instanceof t)){var r=new t(e,n);return r.open(),r}this.id=t.id++,this.setup(e,n),this.chainCallbacks(t._callbackChain)}if(void 0!==e)if(e.fn.jquery.match(/-ajax/))"console"in window&&window.console.info("Featherlight needs regular jQuery, not the slim version.");else{var n=[],r=function(t){return n=e.grep(n,function(e){return e!==t&&e.$instance.closest("body").length>0})},i={keyup:"onKeyUp",resize:"onResize"},o=function(n){e.each(t.opened().reverse(),function(){if(!n.isDefaultPrevented()&&!1===this[i[n.type]](n))return n.preventDefault(),n.stopPropagation(),!1})},a=function(n){if(n!==t._globalHandlerInstalled){t._globalHandlerInstalled=n;var r=e.map(i,function(e,n){return n+"."+t.prototype.namespace}).join(" ");e(window)[n?"on":"off"](r,o)}};t.prototype={constructor:t,namespace:"featherlight",targetAttr:"data-target",variant:null,resetCss:!1,background:null,openTrigger:"click",closeTrigger:"click",filter:null,root:"body",closeOnClick:"background",closeOnEsc:!0,loading:'<div class="featherlight-loader"></div>',persist:!1,otherClose:null,beforeOpen:e.noop,beforeContent:e.noop,beforeClose:e.noop,afterOpen:e.noop,afterContent:e.noop,afterClose:e.noop,onKeyUp:e.noop,onResize:e.noop,type:null,closeIcon:"&#x2716;",contentFilters:["jquery","image","html","ajax","iframe","text"],width:"",height:"",requireWindowWidth:null,setup:function(t,n){"object"!=typeof t||t instanceof e!=!1||n||(n=t,t=void 0);var r=e.extend(this,n,{target:t}),i=r.resetCss?r.namespace+"-reset":r.namespace,o=e(r.background||['<div class="'+i+"-loading "+i+'">','<div class="'+i+'-content">','<div class="'+r.namespace+'-inner">'+r.loading+"</div>","</div>","</div>"].join("")),a="."+r.namespace+"-close"+(r.otherClose?","+r.otherClose:"");return r.$instance=o.clone().addClass(r.variant),r.$instance.on(r.closeTrigger+"."+r.namespace,function(t){var n=e(t.target);("background"===r.closeOnClick&&n.is("."+r.namespace)||"anywhere"===r.closeOnClick||n.closest(a).length)&&(r.close(t),t.preventDefault())}),this},getContent:function(){if(!1!==this.persist&&this.$content)return this.$content;var t=this,n=this.constructor.contentFilters,r=function(e){return t.$currentTarget&&t.$currentTarget.attr(e)},i=r(t.targetAttr),o=t.target||i||"",a=n[t.type];if(!a&&o in n&&(a=n[o],o=t.target&&i),o=o||r("href")||"",!a)for(var s in n)t[s]&&(a=n[s],o=t[s]);if(!a){var c=o;if(o=null,e.each(t.contentFilters,function(){return(a=n[this]).test&&(o=a.test(c)),!o&&a.regex&&c.match&&c.match(a.regex)&&(o=c),!o}),!o)return"console"in window&&window.console.error("Featherlight: no content filter found "+(c?' for "'+c+'"':" (no target specified)")),!1}return a.process.call(t,o)},setContent:function(e){return this.$instance.removeClass(this.namespace+"-loading"),this.$content=e.show(),this.$instance.find("."+this.namespace+"-content").html(this.$content),this.closeIcon&&this.$instance.find("."+this.namespace+"-content").prepend('<div class="'+this.namespace+"-close-icon "+this.namespace+'-close" aria-label="Close">'+this.closeIcon+"</div>"),this},open:function(t){var r=this;if(t&&(t.ctrlKey||t.shiftKey))return!1;if(r.requireWindowWidth&&r.requireWindowWidth>e(window).width())return!1;if(r.$instance.hide().appendTo(r.root),!(t&&t.isDefaultPrevented()||!1===r.beforeOpen(t))){e("body").addClass("featherlight-open"),e(".featherlight").removeClass("active"),r.$instance.addClass("active"),t&&t.preventDefault();var i=r.getContent();if(i)return n.push(r),a(!0),r.$instance.show(),r.beforeContent(t),e.when(i).always(function(e){r.setContent(e),r.width&&r.$content.parent().css("width",r.width),r.height&&r.$content.parent().css("height",r.height),r.afterContent(t)}).then(r.$instance.promise()).done(function(){r.afterOpen(t)})}return r.$instance.detach(),e.Deferred().reject().promise()},close:function(t){var n=e.Deferred();return!1===this.beforeClose(t)?n.reject():(0===r(this).length&&a(!1),this.$instance.hide().detach(),this.afterClose(t),n.resolve(),e(".featherlight:not(.active)").filter(":last").addClass("active"),0===e(".featherlight").length&&e("body").removeClass("featherlight-open")),n.promise()},chainCallbacks:function(t){for(var n in t)this[n]=e.proxy(t[n],this,e.proxy(this[n],this))}},e.extend(t,{id:0,autoBind:'[data-toggle="featherlight"]',defaults:t.prototype,contentFilters:{jquery:{regex:/^[#.]\w/,test:function(t){return t instanceof e&&t},process:function(t){return!1!==this.persist?e(t):e(t).clone(!0)}},image:{regex:/\.(png|jpg|jpeg|gif|tiff?|bmp|svg)(\?\S*)?$/i,process:function(t){var n=e.Deferred(),r=new Image,i=e('<img src="'+t+'" alt="" />');return r.onload=function(){i.naturalWidth=r.width,i.naturalHeight=r.height,n.resolve(i)},r.onerror=function(){n.reject(i)},r.src=t,n.promise()}},html:{regex:/^\s*<[\w!][^<]*>/,process:function(t){return e(t)}},ajax:{regex:/./,process:function(t){var n=e.Deferred(),r=e("<div></div>").load(t,function(e,t){"error"!==t&&n.resolve(r.contents()),n.fail()});return n.promise()}},iframe:{process:function(t){var n=new e.Deferred,r=e("<iframe/>");return r.hide().attr("src",t).on("load",function(){n.resolve(r.show())}).appendTo(this.$instance.find("."+this.namespace+"-content")),n.promise()}},text:{process:function(t){return e("<div>",{text:t})}}},functionAttributes:["beforeOpen","afterOpen","beforeContent","afterContent","beforeClose","afterClose"],readElementConfig:function(t){var n=this,r=new RegExp("^data-(.*)"),i={};return t&&t.attributes&&e.each(t.attributes,function(){var t=this.name.match(r);if(t){var o=this.value,a=e.camelCase(t[1]);if(e.inArray(a,n.functionAttributes)>=0)o=new Function(o);else try{o=JSON.parse(o)}catch(e){}i[a]=o}}),i},extend:function(t,n){var r=function(){this.constructor=t};return r.prototype=this.prototype,t.prototype=new r,t.__super__=this.prototype,e.extend(t,this,n),t.defaults=t.prototype,t},attach:function(t,n,r){var i=this;"object"!=typeof n||n instanceof e!=!1||r||(r=n,n=void 0);(r=e.extend({},r)).namespace||i.defaults.namespace;var o,a=e.extend({},i.defaults,i.readElementConfig(t[0]),r),s=function(a){var s=e(a.currentTarget),c=e.extend({$source:t,$currentTarget:s},i.readElementConfig(t[0]),i.readElementConfig(this),r),l=o||s.data("featherlight-persisted")||new i(n,c);"shared"===l.persist?o=l:!1!==l.persist&&s.data("featherlight-persisted",l),c.$currentTarget.blur&&c.$currentTarget.blur(),l.open(a)};return t.on(a.openTrigger+"."+a.namespace,a.filter,s),s},current:function(){var e=this.opened();return e[e.length-1]||null},opened:function(){var t=this;return r(),e.grep(n,function(e){return e instanceof t})},close:function(e){var t=this.current();if(t)return t.close(e)},_onReady:function(){var t=this;t.autoBind&&(e(t.autoBind).each(function(){t.attach(e(this))}),e(document).on("click",t.autoBind,function(n){if(!n.isDefaultPrevented()){t.attach(e(n.currentTarget))(n)}}))},_callbackChain:{onKeyUp:function(t,n){return 27===n.keyCode?(this.closeOnEsc&&e.featherlight.close(n),!1):t(n)},beforeOpen:function(t,n){return this._previouslyActive=document.activeElement,this._$previouslyTabbable=e("a, input, select, textarea, iframe, button, iframe, [contentEditable=true]").not("[tabindex]").not(this.$instance.find("button")),this._$previouslyWithTabIndex=e("[tabindex]").not('[tabindex="-1"]'),this._previousWithTabIndices=this._$previouslyWithTabIndex.map(function(t,n){return e(n).attr("tabindex")}),this._$previouslyWithTabIndex.add(this._$previouslyTabbable).attr("tabindex",-1),document.activeElement.blur&&document.activeElement.blur(),t(n)},afterClose:function(t,n){var r=t(n),i=this;return this._$previouslyTabbable.removeAttr("tabindex"),this._$previouslyWithTabIndex.each(function(t,n){e(n).attr("tabindex",i._previousWithTabIndices[t])}),this._previouslyActive.focus(),r},onResize:function(e,t){return e(t)},afterContent:function(e,t){var n=e(t);return this.$instance.find("[autofocus]:not([disabled])").focus(),this.onResize(t),n}}}),e.featherlight=t,e.fn.featherlight=function(e,n){return t.attach(this,e,n),this},e(document).ready(function(){t._onReady()})}else"console"in window&&window.console.error("Featherlight requires jQuery.")}(jQuery);